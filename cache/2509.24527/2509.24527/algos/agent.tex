\begin{wrapfigure}[21]{R}{0.44\textwidth}
\vspace*{-5ex}\hfill%
\begin{minipage}{0.43\textwidth}
\begin{algorithm}[H]
\caption{\enskip\method}
\label{alg:agent}
\begin{hyphenrules}{nohyphenation}

\begin{algorithmic}[1]
\setlength{\itemsep}{.5ex}

\vspace{1ex}
\Statex \hspace*{-2.3ex}\textbf{Phase 1:} World Model Pretraining
\State Train tokenizer on videos using \cref{eq:tok}.
\State Train world model on tokenized videos and optionally actions using \cref{eq:dyn}.

\vspace{1ex}
\Statex \hspace*{-2.3ex}\textbf{Phase 2:} Agent Finetuning
\State Finetune world model with task inputs for policy and reward heads using \cref{eq:dyn} and \cref{eq:bcrm}.

\vspace{1ex}
\Statex \hspace*{-2.3ex}\textbf{Phase 3:} Imagination Training
\State Optimize policy head using \cref{eq:pol} and value head using \cref{eq:val} on trajectories generated by the world model and the policy head.
\vspace{1ex}

\end{algorithmic}
\end{hyphenrules}
\end{algorithm}
\end{minipage}
\end{wrapfigure}